<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<title data-react-helmet="true">Error Handling | Eversoft Coding Standard</title><meta data-react-helmet="true" property="og:url" content="https://eversoft-group.github.io/coding-standard/coding-standard/docs/error-handling-practices/error-handling"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Error Handling | Eversoft Coding Standard"><meta data-react-helmet="true" name="description" content="Use Async-Await or promises for async error handling"><meta data-react-helmet="true" property="og:description" content="Use Async-Await or promises for async error handling"><link data-react-helmet="true" rel="shortcut icon" href="/coding-standard/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://eversoft-group.github.io/coding-standard/coding-standard/docs/error-handling-practices/error-handling"><link data-react-helmet="true" rel="alternate" href="https://eversoft-group.github.io/coding-standard/coding-standard/docs/error-handling-practices/error-handling" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://eversoft-group.github.io/coding-standard/coding-standard/docs/error-handling-practices/error-handling" hreflang="x-default"><link rel="stylesheet" href="/coding-standard/assets/css/styles.b121cd8c.css">
<link rel="preload" href="/coding-standard/assets/js/runtime~main.e702cba1.js" as="script">
<link rel="preload" href="/coding-standard/assets/js/main.06c0cfe7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/coding-standard/"><img src="https://eversoftgroup.com/wp-content/uploads/2020/10/png-logo-of-eversoft-group.png" alt="Eversoft Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="https://eversoftgroup.com/wp-content/uploads/2020/10/png-logo-of-eversoft-group.png" alt="Eversoft Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Eversoft Coding Standard</b></a><a class="navbar__item navbar__link navbar__link--active" href="/coding-standard/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/eversoft-group/coding-stanard" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/coding-standard/docs/intro">Intro</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Project Structure</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Naming Conventions</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Function Guide</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Javascript Coding Standard</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Error Handling Practices</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/coding-standard/docs/error-handling-practices/error-handling">Error Handling</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Testing</a></li><li class="menu__list-item"><a class="menu__link" href="/coding-standard/docs/going-to-production-practices">Going To Production</a></li><li class="menu__list-item"><a class="menu__link" href="/coding-standard/docs/security-practices">Security Practices</a></li><li class="menu__list-item"><a class="menu__link" href="/coding-standard/docs/docker-practices">Docker Practices</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Error Handling</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="use-async-await-or-promises-for-async-error-handling"></a>Use Async-Await or promises for async error handling<a class="hash-link" href="#use-async-await-or-promises-for-async-error-handling" title="Direct link to heading">#</a></h2><p>Handling async errors in callback style is probably the fastest way to hell (a.k.a the pyramid of doom). The best gift you can give to your code is using a reputable promise library or async-await instead which enables a much more compact and familiar code syntax like try-catch</p><p><strong>Otherwise:</strong> Node.js callback style, function(err, response), is a promising way to un-maintainable code due to the mix of error handling with casual code, excessive nesting, and awkward coding patterns</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="use-only-the-built-in-error-object"></a>Use only the built-in Error object<a class="hash-link" href="#use-only-the-built-in-error-object" title="Direct link to heading">#</a></h2><p> Many throw errors as a string or as some custom type – this complicates the error handling logic and the interoperability between modules. Whether you reject a promise, throw an exception or emit an error – using only the built-in Error object (or an object that extends the built-in Error object) will increase uniformity and prevent loss of information. There is <code>no-throw-literal</code> ESLint rule that strictly checks that (although it have some <a href="https://eslint.org/docs/rules/no-throw-literal" target="_blank" rel="noopener noreferrer">limitations</a> which can be solved when using TypeScript and setting the <code>@typescript-eslint/no-throw-literal</code> rule)</p><p><strong>Otherwise:</strong> When invoking some component, being uncertain which type of errors come in return – it makes proper error handling much harder. Even worse, using custom types to describe errors might lead to loss of critical error information like the stack trace!</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="distinguish-operational-vs-programmer-errors"></a>Distinguish operational vs programmer errors<a class="hash-link" href="#distinguish-operational-vs-programmer-errors" title="Direct link to heading">#</a></h2><p>Operational errors (e.g. API received an invalid input) refer to known cases where the error impact is fully understood and can be handled thoughtfully. On the other hand, programmer error (e.g. trying to read an undefined variable) refers to unknown code failures that dictate to gracefully restart the application</p><p><strong>Otherwise:</strong> You may always restart the application when an error appears, but why let ~5000 online users down because of a minor, predicted, operational error? the opposite is also not ideal – keeping the application up when an unknown issue (programmer error) occurred might lead to an unpredicted behavior. Differentiating the two allows acting tactfully and applying a balanced approach based on the given context</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="handle-errors-centrally-not-within-a-middleware"></a>Handle errors centrally, not within a middleware<a class="hash-link" href="#handle-errors-centrally-not-within-a-middleware" title="Direct link to heading">#</a></h2><p> Error handling logic such as mail to admin and logging should be encapsulated in a dedicated and centralized object that all endpoints (e.g. Express middleware, cron jobs, unit-testing) call when an error comes in</p><p><strong>Otherwise:</strong> Not handling errors within a single place will lead to code duplication and probably to improperly handled errors</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="document-api-errors-using-swagger-or-graphql"></a>Document API errors using Swagger or GraphQL<a class="hash-link" href="#document-api-errors-using-swagger-or-graphql" title="Direct link to heading">#</a></h2><p> Let your API callers know which errors might come in return so they can handle these thoughtfully without crashing. For RESTful APIs, this is usually done with documentation frameworks like Swagger. If you&#x27;re using GraphQL, you can utilize your schema and comments as well.</p><p><strong>Otherwise:</strong> An API client might decide to crash and restart only because it received back an error it couldn’t understand. Note: the caller of your API might be you (very typical in a microservice environment)</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="exit-the-process-gracefully-when-a-stranger-comes-to-town"></a>Exit the process gracefully when a stranger comes to town<a class="hash-link" href="#exit-the-process-gracefully-when-a-stranger-comes-to-town" title="Direct link to heading">#</a></h2><p> When an unknown error occurs (a developer error, see best practice 2.3) - there is uncertainty about the application healthiness. Common practice suggests restarting the process carefully using a process management tool like <a href="https://www.npmjs.com/package/forever" target="_blank" rel="noopener noreferrer">Forever</a> or <a href="http://pm2.keymetrics.io/" target="_blank" rel="noopener noreferrer">PM2</a></p><p><strong>Otherwise:</strong> When an unfamiliar exception occurs, some object might be in a faulty state (e.g. an event emitter which is used globally and not firing events anymore due to some internal failure) and all future requests might fail or behave crazily</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="use-a-mature-logger-to-increase-error-visibility"></a>Use a mature logger to increase error visibility<a class="hash-link" href="#use-a-mature-logger-to-increase-error-visibility" title="Direct link to heading">#</a></h2><p> A set of mature logging tools like <a href="https://github.com/pinojs/pino" target="_blank" rel="noopener noreferrer">Pino</a> or <a href="https://www.npmjs.com/package/log4js" target="_blank" rel="noopener noreferrer">Log4js</a>, will speed-up error discovery and understanding. So forget about console.log</p><p><strong>Otherwise:</strong> Skimming through console.logs or manually through messy text file without querying tools or a decent log viewer might keep you busy at work until late</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="test-error-flows-using-your-favorite-test-framework"></a>Test error flows using your favorite test framework<a class="hash-link" href="#test-error-flows-using-your-favorite-test-framework" title="Direct link to heading">#</a></h2><p> Whether professional automated QA or plain manual developer testing – Ensure that your code not only satisfies positive scenarios but also handles and returns the right errors. Testing frameworks like Mocha &amp; Chai can handle this easily (see code examples within the &quot;Gist popup&quot;)</p><p><strong>Otherwise:</strong> Without testing, whether automatically or manually, you can’t rely on your code to return the right errors. Without meaningful errors – there’s no error handling</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="discover-errors-and-downtime-using-apm-products"></a>Discover errors and downtime using APM products<a class="hash-link" href="#discover-errors-and-downtime-using-apm-products" title="Direct link to heading">#</a></h2><p> Monitoring and performance products (a.k.a APM) proactively gauge your codebase or API so they can automagically highlight errors, crashes, and slow parts that you were missing</p><p><strong>Otherwise:</strong> You might spend great effort on measuring API performance and downtimes, probably you’ll never be aware which are your slowest code parts under real-world scenario and how these affect the UX</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="catch-unhandled-promise-rejections"></a>Catch unhandled promise rejections<a class="hash-link" href="#catch-unhandled-promise-rejections" title="Direct link to heading">#</a></h2><p> Any exception thrown within a promise will get swallowed and discarded unless a developer didn’t forget to explicitly handle it. Even if your code is subscribed to <code>process.uncaughtException</code>! Overcome this by registering to the event <code>process.unhandledRejection</code></p><p><strong>Otherwise:</strong> Your errors will get swallowed and leave no trace. Nothing to worry about</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="fail-fast-validate-arguments-using-a-dedicated-library"></a>Fail fast, validate arguments using a dedicated library<a class="hash-link" href="#fail-fast-validate-arguments-using-a-dedicated-library" title="Direct link to heading">#</a></h2><p> Assert API input to avoid nasty bugs that are much harder to track later. The validation code is usually tedious unless you are using a very cool helper library like <a href="https://www.npmjs.com/package/ajv" target="_blank" rel="noopener noreferrer">ajv</a> and <a href="https://www.npmjs.com/package/joi" target="_blank" rel="noopener noreferrer">Joi</a></p><p><strong>Otherwise:</strong> Consider this – your function expects a numeric argument “Discount” which the caller forgets to pass, later on, your code checks if Discount!=0 (amount of allowed discount is greater than zero), then it will allow the user to enjoy a discount. OMG, what a nasty bug. Can you see it?</p><br><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="always-await-promises-before-returning-to-avoid-a-partial-stacktrace"></a>Always await promises before returning to avoid a partial stacktrace<a class="hash-link" href="#always-await-promises-before-returning-to-avoid-a-partial-stacktrace" title="Direct link to heading">#</a></h2><p>Always do <code>return await</code> when returning a promise to benefit full error stacktrace. If a
function returns a promise, that function must be declared as <code>async</code> function and explicitly
<code>await</code> the promise before returning it</p><p><strong>Otherwise:</strong> The function that returns a promise without awaiting won&#x27;t appear in the stacktrace.
Such missing frames would probably complicate the understanding of the flow that leads to the error,
especially if the cause of the abnormal behavior is inside of the missing function</p><br></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/error-handling-practices/error-handling.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/coding-standard/docs/general-coding-guidelines/coding-standard"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Coding Standard</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/coding-standard/docs/testing/testring-and-overall-quality-practice"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#use-async-await-or-promises-for-async-error-handling" class="table-of-contents__link">Use Async-Await or promises for async error handling</a></li><li><a href="#use-only-the-built-in-error-object" class="table-of-contents__link">Use only the built-in Error object</a></li><li><a href="#distinguish-operational-vs-programmer-errors" class="table-of-contents__link">Distinguish operational vs programmer errors</a></li><li><a href="#handle-errors-centrally-not-within-a-middleware" class="table-of-contents__link">Handle errors centrally, not within a middleware</a></li><li><a href="#document-api-errors-using-swagger-or-graphql" class="table-of-contents__link">Document API errors using Swagger or GraphQL</a></li><li><a href="#exit-the-process-gracefully-when-a-stranger-comes-to-town" class="table-of-contents__link">Exit the process gracefully when a stranger comes to town</a></li><li><a href="#use-a-mature-logger-to-increase-error-visibility" class="table-of-contents__link">Use a mature logger to increase error visibility</a></li><li><a href="#test-error-flows-using-your-favorite-test-framework" class="table-of-contents__link">Test error flows using your favorite test framework</a></li><li><a href="#discover-errors-and-downtime-using-apm-products" class="table-of-contents__link">Discover errors and downtime using APM products</a></li><li><a href="#catch-unhandled-promise-rejections" class="table-of-contents__link">Catch unhandled promise rejections</a></li><li><a href="#fail-fast-validate-arguments-using-a-dedicated-library" class="table-of-contents__link">Fail fast, validate arguments using a dedicated library</a></li><li><a href="#always-await-promises-before-returning-to-avoid-a-partial-stacktrace" class="table-of-contents__link">Always await promises before returning to avoid a partial stacktrace</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/coding-standard/docs/intro">Coding Standard</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Linkedln<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://eversoftgroup.com/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2021 Eversoft.</div></div></div></footer></div>
<script src="/coding-standard/assets/js/runtime~main.e702cba1.js"></script>
<script src="/coding-standard/assets/js/main.06c0cfe7.js"></script>
</body>
</html>